(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["reviews","dialog"],{1127:function(e,t,n){"use strict";n.r(t);var r=n(13),i=n(6),o=n(2666),a=n.n(o),s=n(4),c=n.n(s),l=n(7),u=n(8),d=n(1128),p=n(443),m=n(542),v=n(39),f=n(578),h=n(9),g=n(21),w=n(545),_=n(835),b=n(20),E=Object(b.a)({resolved:{},chunkName:function(){return"good-place"},isReady:function(e){var t=this.resolve(e);return!1!==this.resolved[t]&&!!n.m[t]},importAsync:function(){return n.e("good-place").then(n.bind(null,334))},requireAsync:function(e){var t=this,n=this.resolve(e);return this.resolved[n]=!1,Promise.resolve(this.importAsync(e)).then(function(e){return t.resolved[n]=!0,e})},requireSync:function e(t){var r=this.resolve(t);return n(r)},resolve:function e(){return 334}}),C=Object(l.a)("reviews-view"),R=function(e){function t(t){var n;return(n=e.call(this,t)||this)._loadMore=function(e){e.preventDefault(),n.state.expanded?n.props.loadMore():n.setState({expanded:!0})},n._renderReview=function(e){var t=n.props;return s.createElement("div",{className:C("review"),key:e.reviewId},s.createElement(p.default,{review:e,onEdit:function(){return t.editReview()},onDelete:t.deleteReview,onRestore:t.restoreReview,showPhoto:t.showPhoto,addUserReaction:t.addUserReaction,businessId:t.result.id,businessTitle:t.result.title,isUserOwner:t.result.isUserOwner,view:"wide"}))},n._renderLoadMoreButton=function(e){var t=n.props,r=g.c(t.result,{sublanding:"reviews"},t.config);return s.createElement(u.a,{name:"show_more",logClick:!0},s.createElement("a",{href:r,className:C("more"),onClick:n._loadMore},(function(params){return (params.count?"Ещё "+params.count+" "+(params.count % 10 === 1 && params.count % 100 !== 11 ? "отзыв" :(params.count % 10 > 1 && params.count % 10 < 5 && (params.count % 100 < 10 || params.count % 100 > 20) ? "отзыва" : "отзывов")):"Ещё нет отзывов");})({count:e})))},n._renderUserReview=function(){var e=n.props;return e.userReview||e.isDeleted?s.createElement(u.a,{name:"reviews"},s.createElement("div",{className:C("review",{"is-own":!0,deleted:e.isDeleted,single:0===e.count})},e.isDeleted?null:s.createElement("div",{className:C("you-rated-this-place")},"Вы оценили это место"),s.createElement(p.default,{review:e.userReview,isDeleted:e.isDeleted,isOwn:!0,onEdit:function(){return e.editReview()},onDelete:e.deleteReview,onRestore:e.restoreReview,showPhoto:e.showPhoto,addUserReaction:e.addUserReaction,businessId:e.result.id,businessTitle:e.result.title,isUserOwner:e.result.isUserOwner,view:"wide"}))):null},n._renderReviews=function(){var e=n.props,t=n.state.expanded,r=e.config.reviews,i=t?e.reviews:e.reviews.slice(0,r.wideCardInitialAmount),o=t?Math.min(e.pageSize,e.count-e.reviews.length):e.reviews.length-r.wideCardInitialAmount;return s.createElement(u.a,{name:"reviews",logViewportEnter:"when appears on screen"},s.createElement("div",{className:C("reviews")},i.map(n._renderReview),e.isLoading?s.createElement("div",{className:C("loader")},s.createElement(v.a,{view:"medium"})):null,(e.hasMore||!t)&&o>0?n._renderLoadMoreButton(o):null))},n._renderHeader=function(){var e,t=n.props,i=n.props.result.ratingData;return s.createElement("div",{className:C("header")},s.createElement("div",{className:C("summary")},s.createElement(w.a,Object(r.a)({ratingValue:i.ratingValue,ratingCount:i.ratingCount},t)),t.userReview||t.isUserReviewLoading?null:s.createElement("div",{className:C("summary-review",{"has-rating":Boolean(i.ratingValue)})},s.createElement(d.a,Object(r.a)({},t,{businessId:t.result.id}))),(null===(e=t.result.awards)||void 0===e?void 0:e.goodPlaceYear)?s.createElement(E,{goodPlaceYear:t.result.awards.goodPlaceYear}):null))},n._renderTitle=function(){var e=n.props;return e.count>0?s.createElement("div",{className:C("title")},s.createElement("h2",{className:C("title-text")},(function(params){return params.count+" "+(params.count % 10 === 1 && params.count % 100 !== 11 ? "отзыв" :(params.count % 10 > 1 && params.count % 10 < 5 && (params.count % 100 < 10 || params.count % 100 > 20) ? "отзыва" : "отзывов"));})({count:e.count})),s.createElement("div",{className:C("ranking")},s.createElement(m.a,{ranking:e.ranking,onUpdate:e.updateRanking}))):null},n.state={expanded:Boolean(t.initiallyExpanded)},n}return Object(i.a)(t,e),t.prototype.render=function(){var e=this.props;return s.createElement("section",{className:C({"has-tags":e.tags.length>0}),ref:e.nodeRef},this._renderHeader(),e.result.personalRating&&e.config.experiments.ui.personalRating?s.createElement("div",{className:C("personal-rating")},s.createElement(_.a,{personalRating:e.result.personalRating})):null,this._renderUserReview(),this._renderTitle(),e.tags.length>0?s.createElement("div",{className:C("tags-container")},s.createElement(f.default,{tags:e.tags,selectedTag:e.selectedTag,onClick:e.onTagClick,initiallyAllShown:!0})):null,e.isLoading||0!==e.reviews.length?this._renderReviews():null)},t}(s.PureComponent);t.default=Object(h.b)(R)},1128:function(e,t,n){"use strict";var r=n(6),i=(n(2668),n(4)),o=n(12),a=n(7),s=n(8),c=n(392),l=n(17),u=n(9),d=n(27),p=Object(a.a)("business-review-suggestion-view"),m=Object(l.a)(o.b(function(e){return{timeContext:e.timeContext}}),u.b,d.b),v=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderRateSuggestion=function(){return i.createElement(s.a,{name:"rate_suggestion"},i.createElement("div",{className:p("rate")},i.createElement("div",{className:p("rate-text")},t.props.isWideCard?"Оцените это место":"Оцените и напишите отзыв"),i.createElement(s.a,{name:"rate_stars",metrikaGoal:"deepuse",logClick:!0},i.createElement(c.a,{rating:null,onRatingClick:t.props.editReview,size:t.props.isWideCard?"s":"l"}))))},t}return Object(r.a)(t,e),t.prototype.render=function(){return this.props.userReview?null:i.createElement("div",{className:p({wide:this.props.isWideCard})},this._renderRateSuggestion())},t}(i.PureComponent);t.a=m(v)},113:function(e,t,n){"use strict";n(153);var r=n(4),i=n(7),o=n(8),a=n(9),s=n(59),c=Object(i.a)("business-rating-badge-view");t.a=Object(a.b)(function(e){var t=Math.round(2*e.ratingValue),n=Math.floor(t/2),i=!1;2*n!==t&&(i=!0);var a=e.size||"m";return r.createElement(o.a,{name:"business_rating"},r.createElement("span",{className:c({size:a})},r.createElement("div",{className:c("stars")},new Array(5).fill(null).map(function(e,t){return r.createElement("span",{className:c("star",{half:i&&t===n,empty:t>=(i?n+1:n),size:a}),key:t})})),e.onlyStars?null:r.createElement("span",{className:c("rating")},r.createElement("span",{className:c("rating-text",{size:a})},s.b(e.ratingValue,e.config.lang,{min:1,max:1})))))})},1151:function(e,t,n){"use strict";n.r(t);var r=n(6),i=n(4),o=n(12),a=n(37),s=n(17),c=n(9),l=n(16),u=n(427),d=(n(2258),n(7)),p=n(18),m=n(40),v=n(882);var f=n(15),h=Object(d.a)("business-review-dialog-form"),g=function(e){function t(t){var n;return(n=e.call(this,t)||this)._setPhotosLoader=function(e){n._photosLoader=e},n._saveReview=function(e){var t=n.props,r=n.state;(Number(t.rating)!==Number(r.rating)||t.description!==r.description.trim()||r.photosChanged)&&t.updateReview(r.rating,r.description,e||[]),n.setState({showGratitude:!0})},n._onSubmit=function(){0!==n.state.photosCount?n._photosLoader&&(n.setState({isPhotoLoading:!0}),n._photoLoadAction=p.a.create(n._photosLoader(),{success:function(e){var t=e.ids;e.allUploaded&&(n._saveReview(t),n.setState({photosChanged:!1})),n.setState({isPhotoLoading:!1})}})):n._saveReview()},n._updateRating=function(e){n.setState({rating:e})},n._updateDescription=function(e){n.setState({description:e})},n._onPhotosChange=function(e){n.setState({photosChanged:!0,photosCount:e.length})},n._renderGratitude=function(){return i.createElement("div",{className:h("gratitude")},i.createElement("div",{className:h("gratitude-icon")}),i.createElement("div",{className:h("gratitude-title")},"Спасибо, что делаете Яндекс.Карты лучше"),i.createElement("div",{className:h("gratitude-subtitle")},"Ваши отзывы помогают другим пользователям карт определиться с выбором"),i.createElement(f.a,{view:"primary",size:"small",onClick:n.props.onClose},"Хорошо"))},n._renderActiveView=function(){var e=n.state,t=n.props;return e.showGratitude?n._renderGratitude():i.createElement(v.a,{description:e.description,rating:e.rating,title:t.title,address:t.address,allowSubmit:!t.isLoading&&null!==e.rating,updateRate:n._updateRating,updateDescription:n._updateDescription,setPhotosLoader:n._setPhotosLoader,onSubmit:n._onSubmit,onClose:t.onClose,photos:t.userPhotos,isLoading:e.isPhotoLoading,config:t.config,businessId:t.businessId,onChangePhotos:n._onPhotosChange,photosCount:e.photosCount})},n.state={description:t.description||"",rating:t.rating,showGratitude:!1,isPhotoLoading:!1,photosCount:t.userPhotos.length,photosChanged:!1},n}Object(r.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=this.props,n=this.state,r=e.isOpen,i=e.description,o=t.isOpen,a=t.description,s=t.rating,c=n.description,l=n.rating,u=!r&&o;if(u||!c&&a&&i!==a||!l&&s){var d={description:a||c||"",rating:s||l,isPhotoLoading:n.isPhotoLoading,photosCount:t.userPhotos.length,photosChanged:!1,showGratitude:!u&&n.showGratitude};this.setState(d)}},n.componentWillUnmount=function(){p.a.cancel(this._photoLoadAction)},n.render=function(){var e=this.state,t=this.props,n=e.showGratitude?void 0:"Оценить и оставить отзыв";return i.createElement(m.default,{isOpen:t.isOpen,onClose:t.onClose,mobileTitle:n,showCloseButton:!0},this._renderActiveView())},t}(i.PureComponent),w=Object(c.b)(g),_=n(298),b={closeReviewsDialog:a.a.close},E=Object(s.a)(o.b(function(e){var t,n,r,i,o=l.h(e,"reviews"),a=l.h(e,"orgpage"),s=null===(t=l.h(e,"search-result"))||void 0===t?void 0:null===(n=t.response)||void 0===n?void 0:n.items[0];return{initialRate:"editor"===(null==o?void 0:o.type)?o.initialRate:void 0,page:null==o?void 0:o.type,result:null!==(r=null!==(i=null==o?void 0:o.result)&&void 0!==i?i:null==a?void 0:a.result)&&void 0!==r?r:"business"===(null==s?void 0:s.type)?s:void 0}},b),c.b),C=function(e){function t(){return e.apply(this,arguments)||this}return Object(r.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.result,n=e.config.reviews.wideCardLandingAmount;return t?i.createElement("div",{className:"reviews-component"},i.createElement(u.a,{result:t,pageSize:n},function(n){return i.createElement(w,{isOpen:"editor"===e.page,onClose:e.closeReviewsDialog,title:t.title,address:t.address,description:n.userReview?n.userReview.text:void 0,userPhotos:n.userReview?n.userReview.photos:[],rating:e.initialRate||(n.userReview?_.b(n.userReview.rating):null),updateReview:n.updateReview,isLoading:n.isLoading,businessId:t.id})})):i.createElement("div",{className:"reviews-component"})},t}(i.PureComponent);t.default=E(C)},130:function(e,t,n){e.exports=n.p+"_/c6253bebae4891e27181f3a4bb34a342.svg"},136:function(e,t,n){"use strict";var r,i=n(6),o=n(4),a=[],s=!1;function c(e){0===(a=a.filter(function(t){return t!==e})).length&&r&&r.disconnect()}var l=function(e){function t(){return e.apply(this,arguments)||this}Object(i.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e,t;s||(e=this.props.listener,(t=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)&&(r||(r=new t(function(e){var t=e.find(function(e){return"class"===e.attributeName});if(t){var n=t.target.getAttribute("class");n&&(s=n.includes("_font_loaded"))&&setTimeout(function(){a.forEach(function(e){e(),c(e)})},1)}})).observe(window.document.getElementsByTagName("body")[0],{attributes:!0,attributeFilter:["class"]}),a.push(e)))},n.componentWillUnmount=function(){c(this.props.listener)},n.render=function(){return null},t}(o.PureComponent);t.a=l},137:function(e,t,n){"use strict";n(175);var r=n(4),i=n(7),o=n(8),a=Object(i.a)("business-rating-amount-view");t.a=function(e){return r.createElement(o.a,{name:"ratings_amount"},r.createElement("span",{className:a({summary:e.isSummary})},(function(params){return (params.count?params.count+" "+(params.count % 10 === 1 && params.count % 100 !== 11 ? "оценка" :(params.count % 10 > 1 && params.count % 10 < 5 && (params.count % 100 < 10 || params.count % 100 > 20) ? "оценки" : "оценок")):"Ещё нет оценок");})({count:e.ratingCount})))}},150:function(e,t,n){},152:function(e,t,n){e.exports=n.p+"_/ab65d8cbf4996eb9048efd9031d9f38b.svg"},153:function(e,t,n){},156:function(e,t,n){"use strict";var r=n(13),i=n(6),o=(n(186),n(4)),a=n(7),s=n(53),c=n(41),l=o.useLayoutEffect,u=function(e){var t=Object(o.useRef)(e);return l(function(){t.current=e}),t},d=function(e,t){"function"!=typeof e?e.current=t:e(t)},p=function(e,t){var n=Object(o.useRef)();return Object(o.useCallback)(function(r){e.current=r,n.current&&d(n.current,null),n.current=t,t&&d(t,r)},[t])},m={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},v=function(e){Object.keys(m).forEach(function(t){e.style.setProperty(t,m[t],"important")})},f=null,h=function(e,t){var n=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?n+t.borderSize:n-t.paddingSize};var g=function(){},w=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width"],_=!!document.documentElement.currentStyle,b=function(e,t){var n=e.cacheMeasurements,i=e.maxRows,a=e.minRows,s=e.onChange,l=void 0===s?g:s,d=e.onHeightChange,m=void 0===d?g:d,b=Object(c.a)(e,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]);var E,C=void 0!==b.value,R=Object(o.useRef)(null),S=p(R,t),y=Object(o.useRef)(0),N=Object(o.useRef)(),O=function(){var e=R.current,t=n&&N.current?N.current:function(e){var t=window.getComputedStyle(e);if(null===t)return null;var n,r=(n=t,w.reduce(function(e,t){return e[t]=n[t],e},{})),i=r.boxSizing;return""===i?null:(_&&"border-box"===i&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px"),{sizingStyle:r,paddingSize:parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),borderSize:parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth)})}(e);if(t){N.current=t;var r=function(e,t,n,r){void 0===n&&(n=1),void 0===r&&(r=1/0),f||((f=document.createElement("textarea")).setAttribute("tab-index","-1"),f.setAttribute("aria-hidden","true"),v(f)),null===f.parentNode&&document.body.appendChild(f);var i=e.paddingSize,o=e.borderSize,a=e.sizingStyle,s=a.boxSizing;Object.keys(a).forEach(function(e){var t=e;f.style[t]=a[t]}),v(f),f.value=t;var c=h(f,e);f.value="x";var l=f.scrollHeight-i,u=l*n;"border-box"===s&&(u=u+i+o),c=Math.max(u,c);var d=l*r;return"border-box"===s&&(d=d+i+o),[c=Math.min(d,c),l]}(t,e.value||e.placeholder||"x",a,i),o=r[0],s=r[1];y.current!==o&&(y.current=o,e.style.setProperty("height",o+"px","important"),m(o,{rowHeight:s}))}};return Object(o.useLayoutEffect)(O),E=u(O),Object(o.useLayoutEffect)(function(){var e=function(e){E.current(e)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}},[]),Object(o.createElement)("textarea",Object(r.a)({},b,{onChange:function(e){C||O(),l(e)},ref:S}))},E=Object(o.forwardRef)(b),C=Object(a.a)("textarea"),R=function(e){function t(t){var n;return(n=e.call(this,t)||this)._textarea=o.createRef(),n._onChange=function(e){n.props.onChange(e.currentTarget.value)},n._onClick=function(){n._textarea.current.focus()},n._onFocus=function(){var e=n.props;e.selectOnFocus&&n._textarea.current.select(),e.onFocus&&e.onFocus(),n.setState({focused:!0})},n._onBlur=function(){var e=n.props;e.onBlur&&e.onBlur(),n.setState({focused:!1})},n._onKeyDown=function(e){var t,r=n.props;null===(t=r.onKeyDown)||void 0===t||t.call(r,e),r.onEnterSubmit&&e.keyCode===s.a.ENTER&&!e.shiftKey&&(n._textarea.current.blur(),r.onEnterSubmit())},n.state={focused:!1},n}return Object(i.a)(t,e),t.prototype.render=function(){var e=this.props,t=C({disabled:e.disabled,focused:this.state.focused,size:e.size,invalid:e.invalid,view:e.view,filled:e.value.length>0}),n={className:C("control"),value:e.value,id:e.id,name:e.name,tabIndex:e.tabIndex,disabled:e.disabled,maxLength:e.maxLength,placeholder:e.placeholder,autoComplete:"off",autoCorrect:"off",autoFocus:e.autoFocus,rows:e.rows,onKeyDown:this._onKeyDown,onChange:this._onChange,onFocus:this._onFocus,onBlur:this._onBlur};return o.createElement("span",{className:t,onClick:this._onClick},e.autoHeight?o.createElement(E,Object(r.a)({ref:this._textarea},n,{maxRows:e.maxRows,minRows:e.rows,translate:"off",style:{resize:"none",overflow:e.maxRows?"auto":"hidden"}})):o.createElement("textarea",Object(r.a)({ref:this._textarea},n,{style:{maxHeight:e.maxHeight+"px",resize:e.resizeable?"vertical":"none"}})))},t}(o.PureComponent);t.a=R},161:function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"f",function(){return l}),n.d(t,"b",function(){return u}),n.d(t,"e",function(){return d}),n.d(t,"a",function(){return p});var r=["X5L","X4L","XXXL","XXL","XL","L","M","S","XS"],i=["XL","L","M","S","XS"];function o(e,t){var n=null,r=!0;return 1===e.length?(r=!1,n=0):void 0!==t.isPreviewMode&&(r=t.isPreviewMode),t.selectedId&&(-1===(n=e.findIndex(function(e){return"id"in e&&e.id===t.selectedId}))?n=0:r=!1),{selectedIndex:n,isPreviewMode:r}}function a(e){return e.name+"["+e.size+"]@"+e.lastModified}var s=1048576;function c(e,t){if(e.hashes.some(function(e){return a(t)===e}))return Promise.resolve({state:"rejected",error:"Изображение уже загружено"});if(e.maxSize&&t.size/s>e.maxSize)return Promise.resolve({state:"rejected",error:"Фотография слишком большая, уменьшите её и попробуйте снова"});var n,r,i,o={state:"fulfilled",photo:{preview:window.URL.createObjectURL(t),file:t}};return e.resolutionRanges?(n=o.photo.preview,r=e.resolutionRanges,i=new window.Image,new Promise(function(e,t){i.onload=function(){!r||(!r.min||i.naturalWidth>=r.min[0]&&i.naturalHeight>=r.min[1])&&(!r.max||i.naturalWidth<=r.max[0]&&i.naturalHeight<=r.max[1])?e():t()},i.onerror=function(){t()},i.src=n})).then(function(){return o},function(){return{state:"rejected",error:"Разрешение фотографии не подходит, попробуйте загрузить другую"}}):Promise.resolve(o)}function l(e,t){return Promise.all(t.map(function(t){return c(e,t)})).then(function(e){return{valid:e.filter(function(e){return"fulfilled"===e.state}),invalid:e.filter(function(e){return"rejected"===e.state})}})}function u(e){return e.filter(function(e){return Boolean(e.preview&&!e.photoId)})}function d(e){return e.filter(function(e){return Boolean(e.photoId)})}function p(e,t){var n=(t?i:r).find(function(t){return Boolean(e[t])});return n?e[n]:void 0}},171:function(e,t,n){},174:function(e,t,n){},175:function(e,t,n){},185:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(2796),i=n(128),o=n(25),a=n(140),s={posts:"sprav-posts",stories:"maps_stories"},c={getByPoint:function(e,t){return Object(o.a)("photos/getAtPoint",{query:{lang:t.locale,ll:Object(r.a)(e)}},t)},getByBusinessId:function(e,t){return Object(o.a)("photos/getByBusinessId",{query:{id:e}},t)},getByPostId:function(e,t,n){return Object(o.a)("photos/getByPostId",{query:{oid:e,id:t}},n)},getById:function(e,t){return Object(o.a)("photos/getById",{query:{id:e}},t)},uploadBusinessPhoto:function(e){var t=e.config,n=new FormData;return n.append("address_source","ADRESA"),n.append("access","public"),n.append("pub_channel","html"),n.append("app_platform","web"),n.append("app_version","1"),n.append("address",e.businessId),n.append("ut","c"),n.append("ticket",t.xscriptCsrfToken),n.append("yandexuid",a.a.get("yandexuid",t)),n.append("image_source",e.photo,e.photo.name),Object(i.a)({url:t.hosts.photoUploadApi+"api/v1/ugc-photo",query:{appId:"maps-web"},headers:{accept:"application/json"},method:"POST",body:n,credentials:"include",parser:"string"}).then(function(e){var t=JSON.parse(e).response,n=t.status,r=t.image;return{success:"ok"===n,photoId:null==r?void 0:r.id}},function(){return{success:!1}})},uploadFeedbackPhoto:function(e){var t=e.config,n=new FormData;return n.append("ticket",t.xscriptCsrfToken),n.append("yandexuid",a.a.get("yandexuid",t)),n.append("file",e.photo,e.photo.name),Object(i.a)({url:t.hosts.photoUploadApi+"api/v1/feedback-photo",headers:{accept:"application/json"},method:"POST",body:n,credentials:"include",parser:"string"}).then(function(e){var t=JSON.parse(e).id;return{success:Boolean(t),photoId:t}},function(){return{success:!1}})},uploadPostPhoto:function(e,t){return l(e,s.posts,t).then(function(e){return{success:!0,photoId:e["group-id"]+"/"+e.imagename,size:{width:e.sizes.orig.width,height:e.sizes.orig.height}}},function(){return{success:!1}})},uploadStoryPhoto:function(e,t){return l(e,s.stories,t).then(function(e){return"https:"+t.extraHosts.avatarsMds.replace("{namespace}",s.stories).replace("{uid}",e["group-id"]+"/"+e.imagename).replace("{size}","%s")})},uploadUgcPhoto:function(e,t){return Object(i.a)({url:t.hosts.ugcPhotosProxy+"v1/photos/my/upload?filename="+e.name+"&format=json",headers:{"Content-Type":"image/jpeg"},method:"PUT",body:e,credentials:"include"}).then(function(e){return{success:Boolean(e.id),photoId:e.id}},function(){return{success:!1}})}};function l(e,t,n){var r=new FormData;return r.append("file",e,e.name),r.append("ticket",n.xscriptCsrfToken),r.append("yandexuid",a.a.get("yandexuid",n)),Object(i.a)({url:n.hosts.photoUploadApi+"api/v1/avatars",query:{namespace:t},headers:{accept:"application/json"},method:"POST",body:r,credentials:"include",parser:"json"})}t.b=c},186:function(e,t,n){},209:function(e,t,n){},215:function(e,t,n){"use strict";var r=n(25),i={sendAnswer:function(e,t){return Object(r.a)("business/sendAnswer",{body:e},t)},fetchUserReview:function(e,t){return Object(r.a)("business/fetchUserReview",{query:e},t)},fetchUserReviews:function(e,t){return Object(r.a)("business/fetchUserReviews",{query:e},t)},fetchUserPhotos:function(e,t){return Object(r.a)("business/fetchUserPhotos",{query:e},t)},deleteBusinessPhotos:function(e,t){return Object(r.a)("business/deleteUserPhotos",{query:e},t)},sendUserReview:function(e,t){return Object(r.a)("business/sendUserReview",{body:e},t)},addUserReaction:function(e,t){return Object(r.a)("business/addUserReaction",{body:e},t)},fetchReviews:function(e,t){return Object(r.a)("business/fetchReviews",{query:e},t)},fetchServiceZone:function(e,t){return Object(r.a)("business/fetchServiceZone",{query:{businessId:e,lang:t.lang,locale:t.locale}},t)},fetchUserImpressions:function(e,t){return Object(r.a)("business/fetchUserImpressions",{query:e},t)},answerSbsQuestionImpression:function(e,t){return Object(r.a)("business/answerSbsQuestionImpression",{query:e},t)},skipImpression:function(e,t){return Object(r.a)("business/skipImpression",{query:e},t)}};t.a=i},2258:function(e,t,n){},2666:function(e,t,n){},2668:function(e,t,n){},2670:function(e,t,n){},2672:function(e,t,n){},2674:function(e,t,n){},2676:function(e,t,n){e.exports=n.p+"_/1a4b3ba5edc5325347c620c3b01ff0f1.svg"},2677:function(e,t,n){},2679:function(e,t,n){e.exports=n.p+"_/7a28c387e7175b95c2531c4df39ff608.svg"},2693:function(e,t,n){},27:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(119),i=Object(r.a)("wideCard",!1,function(e){return{isWideCard:e}}),o=i.connect,a=i.Provider;t.b=o},272:function(e,t,n){"use strict";var r=n(10),i=n(71),o=n(6),a=(n(174),n(4)),s=n(117),c=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._input=null,t._preventEvent=function(e){e.preventDefault()},t._onDragOver=function(e){e.preventDefault(),e.stopPropagation(),t.props.onDragOver();try{e.dataTransfer.dropEffect="copy"}catch(n){}},t._onDragLeave=function(e){e.preventDefault(),t.props.onDragLeave()},t._onDrop=function(e){e.preventDefault();var n="dataTransfer"in e?e.dataTransfer.files:e.target.files,r=n?Array.from(n):[],i=t.props.accept.split(","),o=r.filter(function(e){return i.some(function(t){return e.type===t||e.name.endsWith(t)})});t.props.onChange(o),t.props.onDragLeave()},t._onClick=function(){t._input.value="",t._input.click()},t}return Object(o.a)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.children,r=t.accept;return a.createElement("div",{onClick:this._onClick,onDragEnter:this._preventEvent,onDragOver:this._onDragOver,onDragLeave:this._onDragLeave,onDrop:this._onDrop},n,a.createElement("input",{type:"file",accept:r,style:{display:"none"},ref:function(t){e._input=t},onChange:this._onDrop,multiple:!0}),a.createElement(s.a,{type:"dragover",listener:this._preventEvent,options:!1}),a.createElement(s.a,{type:"drop",listener:this._preventEvent,options:!1}))},t}(a.Component),l=n(7),u=n(8),d=n(161),p=n(22),m=n(11),v=n(18),f=n(9),h=n(293),g=n.n(h),w=(n(294),Object(l.a)("add-photos-view")),_=function(e){function t(t){var n,o;return(o=e.call(this,t)||this)._ref=a.createRef(),o._photosLoader=function(){var e=Object(i.a)(o),t=e.props,n=e.state;v.a.cancel(o._uploadAction);var a=d.b(n.photos);return new Promise(function(e){o._uploadAction=v.a.create(Promise.all(a.map(function(e){return t.photosLoaderProvider(e.file)})),{success:function(i){var s=n.photos.map(function(e){if(!("file"in e))return e;var t=a.findIndex(function(t){return d.c(t.file)===d.c(e.file)});return-1!==t?Object(r.a)(Object(r.a)({},e),{},{photoId:i[t].photoId,size:i[t].size}):e});o._setPhotos(t.removeUploaded?d.b(s):s),o.setState({error:i.some(function(e){return!e.success})?"Некоторые фотографии не удалось загрузить, попробуйте позже.":void 0});var c=s.map(function(e){return e.photoId||null}),l=c.filter(function(e){return null!==e});e({ids:l,allUploaded:c.length===l.length})}})})},o._onChange=function(e){var t=o.props;o._resetError(),v.a.cancel(o._changeAction),o._changeAction=v.a.create(d.f({hashes:o.state.photos.map(function(e){return"urlTemplate"in e?null:d.c(e.file)}).filter(function(e){return Boolean(e)}),maxSize:t.maxSize,resolutionRanges:t.resolutionRanges},e),{success:function(e){var n=[].concat(o.state.photos,e.valid.map(function(e){return e.photo})),r=t.maxCount;o._setPhotos(n.slice(0,r)),r&&n.length>r?o.setState({error:(function(params){return "Вы можете загрузить не более "+params.maxCount+" фотографий";})({maxCount:r})}):e.invalid[0]&&o.setState({error:e.invalid[0].error})}})},o._removePhoto=function(e){o._setPhotos(o.state.photos.filter(function(t){return t!==e}))},o._resetError=function(){o.setState({error:void 0})},o._setPhotos=function(e){o.setState({photos:e}),o.props.onChange(e)},o._renderPopup=function(){var e=o.state.error;return e?a.createElement(p.a,{type:"error",getTarget:function(){return o._ref.current},onClose:o._resetError,isShown:!0},a.createElement("div",{className:w("error-message")},e)):null},o._renderPhotosPreview=function(){var e=o.state.photos;return 0===e.length?null:a.createElement("div",{className:w("photos")},e.map(o._renderPhoto))},o._renderPhoto=function(e){var t="preview"in e?e.preview:e.urlTemplate.replace(/{?size}?/,"M");return a.createElement("div",{className:w("photo-wrapper"),key:t},a.createElement("img",{className:w("photo"),src:t}),a.createElement("div",{className:w("remove"),onClick:function(){return o._removePhoto(e)}},a.createElement(m.a,{url:g.a})))},o._renderDropzone=function(){var e=Object(i.a)(o),t=e.props,n=e.state;return t.maxCount&&n.photos.length>=t.maxCount?null:a.createElement(c,{accept:t.accept||"image/jpeg,image/png",onChange:o._onChange,onDragOver:function(){return o.setState({bordered:!0})},onDragLeave:function(){return o.setState({bordered:!1})}},a.createElement("div",{className:w("dropzone",{bordered:n.bordered}),ref:o._ref},a.createElement("div",{className:w("dropzone-content")},a.createElement("div",{className:w("dropzone-text")},"Перетащите сюда файлы или"),a.createElement("div",{className:w("select-link")},"выберите на компьютере"))))},o.state={bordered:!1,photos:(null===(n=t.photos)||void 0===n?void 0:n.slice(0,t.maxCount))||[]},o}Object(o.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.setPhotosLoader(this._photosLoader)},n.componentDidUpdate=function(e){var t=this.props;t.photos!==e.photos&&t.photos&&this.setState({photos:t.photos.slice(0,t.maxCount)})},n.componentWillUnmount=function(){v.a.cancel(this._uploadAction),v.a.cancel(this._changeAction)},n.render=function(){return a.createElement(u.a,{name:"add_photos",nodeState:{amount:this.state.photos.length,hasError:Boolean(this.state.error)}},a.createElement("div",{className:w(),ref:this.state.photos.length===this.props.maxCount?this._ref:void 0},this._renderDropzone(),this._renderPhotosPreview(),this._renderPopup()))},t}(a.Component);t.a=Object(f.b)(_)},29:function(e,t,n){"use strict";var r=n(6),i=(n(171),n(4)),o=n(7),a=n(27),s=n(11),c=n(130),l=n.n(c),u=Object(o.a)("card-feature-view"),d=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderIcon=function(){var e=t.props,n=e.iconUrl;if(null===n)return null;var r=e.iconClassName;return i.createElement("div",{className:u("icon-wrapper",{"no-color":e.keepIconColor})+(r?" "+r:"")},n?i.createElement(s.a,{url:n}):e.icon)},t._renderMain=function(){var e=t.props;return i.createElement("div",{className:u("main")},t._renderIcon(),i.createElement("div",{className:u("content")},e.title?i.createElement("div",{className:u("title")},e.title):null,i.createElement("div",{className:u("main-content")},e.children),e.subcontent?i.createElement("div",{className:u("subcontent")},e.subcontent):null))},t._renderAdditional=function(){var e=t.props;return e.value||e.arrowView?i.createElement("div",{className:u("additional"),onClick:e.onAdditionalClick},e.value?i.createElement("div",{className:u("value")},e.value):null,e.arrowView?i.createElement("div",{className:u("arrow",{view:e.arrowView})},i.createElement(s.a,{url:l.a})):null):null},t}return Object(r.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.subcontent,n=e.onClick,r=e.title?"medium":e.size||"large",o=null===e.icon||null===e.iconUrl;return i.createElement("div",{className:u({view:e.view||"normal",size:r,subcontent:Boolean(t),interactive:Boolean(n),"has-title":Boolean(e.title),disabled:e.disabled,"no-icon":o,"no-side-padding":e.noSidePadding||e.isWideCard})+(e.className?" "+e.className:""),onClick:n},i.createElement("div",{className:u("wrapper")},this._renderMain(),this._renderAdditional()),i.createElement("div",{className:u("border",{border:e.border,stretch:e.stretchBorder||o})}))},t}(i.Component);t.a=Object(a.b)(d)},293:function(e,t,n){e.exports=n.p+"_/e2d7155575fee181d439283e90435fc2.svg"},294:function(e,t,n){e.exports=n.p+"_/5524143df43338502f48540a82073467.svg"},298:function(e,t,n){"use strict";function r(e){var t=Number(e);return[1,2,3,4,5].includes(t)?t:null}function i(e,t){var n;return null!==(n=e.reviews.businessReviews[t.id])&&void 0!==n?n:function(e,t){var n,r,i,o,a;return{count:t.ratingData.reviewCount,isLoading:!1,items:null!==(n=null===(r=t.reviewResults)||void 0===r?void 0:r.reviews)&&void 0!==n?n:[],selectedTag:null===(i=e.config.query.reviews)||void 0===i?void 0:i.tag,tags:null!==(o=null===(a=t.reviewResults)||void 0===a?void 0:a.tags)&&void 0!==o?o:[],userReview:e.config.authorization?void 0:null}}(e,t)}n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r})},301:function(e,t,n){},330:function(e,t,n){"use strict";var r=n(10),i=n(6),o=n(4),a=n(136),s=1,c={key:void 0,isCollapsed:!0,updaters:[]},l=function(e){function t(t){var n;return(n=e.call(this,t)||this)._textRef=o.createRef(),n._checkSharedState=function(){var e=n.props.sharedKey;e&&(c.key!==e&&(c={key:e,isCollapsed:!0,updaters:[]}),c.updaters.push(n._updateState),n.setState({isCollapsed:c.isCollapsed}))},n._updateState=function(e){n.setState(e)},n._checkIfOverflown=function(){var e=n._textRef.current;if(e){var t=e.scrollHeight-e.offsetHeight;n.setState({isOverflown:t>s})}},n._onButtonClick=function(e){var t="boolean"==typeof e?e:!n.state.isCollapsed;n.setState({isCollapsed:t}),n.props.sharedKey&&(c.isCollapsed=t,c.updaters.forEach(function(e){return e({isCollapsed:t})}))},n._onShowClick=function(){n._onButtonClick(!1)},n.state={isCollapsed:!0,isOverflown:!1},n}Object(i.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._checkSharedState(),this._checkIfOverflown()},n.componentDidUpdate=function(){this._checkIfOverflown()},n.componentWillUnmount=function(){var e=this;this.props.sharedKey&&(c.updaters=c.updaters.filter(function(t){return t!==e._updateState}),0===c.updaters.length&&(c.key=void 0))},n.render=function(){var e=this.props,t=this.state;return o.createElement(o.Fragment,null,e.children(Object(r.a)(Object(r.a)({},t),{},{ref:this._textRef})),e.renderButton(Object(r.a)(Object(r.a)({},t),{},{onClick:this._onButtonClick,onShowClick:this._onShowClick})),o.createElement(a.a,{listener:this._checkIfOverflown}))},t}(o.PureComponent);t.a=l},35:function(e,t,n){"use strict";var r=n(10),i=n(6),o=(n(63),n(4)),a=n(2800),s=n(2765),c=n(7),l=n(50),u=n(86),d=n(9),p=(n(65),n(8)),m=n(11),v=n(67),f=n.n(v),h=n(68),g=n.n(h),w={l:f.a,m:g.a},_={l:40,m:32},b=Object(c.a)("carousel"),E=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._onPrevClick=function(e){return e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),t.props.setOffsetByDirection(-1)},t._onNextClick=function(e){return e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),t.props.setOffsetByDirection(1)},t._renderButton=function(e){var n;if(!t.props.showButtons[e])return null;var r=t.props,i=r.arrowStyle,a=void 0===i?{}:i,s=r.buttonSize,c=void 0===s?"l":s,l=a.horizontalOffset,u=void 0===l?0:l,d=a.topVerticalOffset,v=_[c]/2,f=void 0!==d,h=f?d-v:0;return o.createElement("div",{className:b("arrow-wrapper",(n={centered:!f},n[e]=!0,n.size=c,n))},o.createElement(p.a,{name:e,logClick:!0,useParentState:!0},o.createElement("div",{className:b("arrow",{size:c}),style:{margin:h+"px "+u+"px"},onClick:"prev"===e?t._onPrevClick:t._onNextClick,onMouseEnter:t.props.onMouseEnter,onMouseLeave:t.props.onMouseLeave},o.createElement(m.a,{className:b("arrow-image"),url:w[c]}))))},t}return Object(i.a)(t,e),t.prototype.render=function(){return o.createElement(o.Fragment,null,this._renderButton("prev"),this._renderButton("next"))},t}(o.Component),C=n(85),R=n(110),S=21,y=Object(c.a)("carousel"),N=function(e){function t(t){var n;return(n=e.call(this,t)||this)._analyticsRef=o.createRef(),n._scrollable=o.createRef(),n._isProgrammaticScroll=!1,n._contentNode=null,n._elementWidth=0,n._insideButton=!1,n._isClickAllowed=!0,n._isSwiping=!1,n._swipeStartScreen=0,n._getCurrentScreen=function(){var e=n._scrollable.current.scrollLeft/(n._elementWidth+n.props.itemsGap),t=n.props.children.length-1;return Math.max(0,Math.min(t,e))},n._onScroll=function(){n.props.snap&&(n._isSwiping?n._checkSwipeEndDebounced():n._onSwipeStart()),n.props.onScroll&&n._scrollable.current&&n.props.onScroll(n._getCurrentScreen(),n._isProgrammaticScroll),n._updateArrowsVisibility()},n._checkSwipeEnd=function(){var e=n._getCurrentScreen();Math.abs(e-Math.round(e))<.03&&n._onSwipeEnd()},n._onSwipeStart=function(){var e,t;(n._isSwiping=!0,n._swipeStartScreen=Math.round(n._getCurrentScreen()),n._isProgrammaticScroll)||(null===(e=(t=n.props).onSwipeStart)||void 0===e||e.call(t))},n._onSwipeEnd=function(){var e,t,r;Math.round(n._getCurrentScreen())===n._swipeStartScreen||n._isProgrammaticScroll||(null===(e=n._analyticsRef.current)||void 0===e||e.logEvent("swipe"));n._isProgrammaticScroll||(null===(t=(r=n.props).onSwipeEnd)||void 0===t||t.call(r));n._isSwiping=!1,n._isProgrammaticScroll=!1},n._setScrollPosition=function(e){if(void 0!==e){var t=e*(n._elementWidth+n.props.itemsGap);n._setOffset(t)}},n._contentRef=function(e){if(n._contentNode=e,e){var t=n.props.padding,r=void 0===t?0:t,i=n.props.expandWidth||{left:0};n._elementWidth=e.children[0].offsetWidth-(r+i.left),setTimeout(n._updateHeight,0)}},n._updateHeight=function(){n._contentNode&&n.setState({height:n._contentNode.clientHeight})},n._updateArrowsVisibility=function(){var e=n._scrollable.current,t=e.scrollLeft,r=e.scrollWidth-e.clientWidth-t,i=n.props.buttonOffset,o=void 0===i?1:i,a=t>o,s=r>o,c=n.state.showButtons;a===c.prev&&s===c.next||(n.setState({showButtons:{prev:a,next:s}}),n._leaveButton())},n._enterButton=function(){n._insideButton=!0,n._isClickAllowed=!1},n._leaveButton=function(){n._insideButton=!1},n._onMouseMove=function(){n._insideButton||n._isClickAllowed||(n._isClickAllowed=!0)},n._checkClick=function(e){n._isClickAllowed||(e.preventDefault(),e.stopPropagation())},n._setOffset=function(e){var t=n._scrollable.current,r=n.state.smoothScroll;t&&(n._isProgrammaticScroll=!0,"scrollBehavior"in document.body.style?t.scrollLeft=e:Object(l.a)({duration:r?350:0,element:t,horizontal:!0,targetPosition:e},n.props.config))},n._setOffsetByDirection=function(e){if(n._scrollable.current){var t=n.props,r=n._elementWidth+t.itemsGap,i=n._scrollable.current.scrollLeft+(t.clickStep||1)*r*e,o=1===e?Math.floor:Math.ceil;n._setOffset(o(i/r)*r)}},n._getScrollableContainerStyles=function(e){var t=n.props,i=n.state,o=Object(r.a)({},t.scrollContainerStyle);t.snap&&!e.has.snapAlign&&(o.scrollSnapPointsX="repeat("+(n._elementWidth+t.itemsGap)+"px)");var a=i.height;return a&&(o.height=a+S,o.paddingBottom=S),o},t.scrollableRef&&(n._scrollable=t.scrollableRef),n.state={showButtons:{prev:!1,next:!0},smoothScroll:!1},n._onScrollThrottled=Object(a.a)(n._onScroll,20),n._checkSwipeEndDebounced=Object(s.a)(n._checkSwipeEnd,200),n}Object(i.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this,t=this.props;t.resetCarouselRef&&t.resetCarouselRef(function(){return e._setOffset(0)}),t.setPositionRef&&t.setPositionRef(function(t){return e._setScrollPosition(t)}),this._scrollable.current.addEventListener("scroll",this._onScrollThrottled,{passive:!0}),this._updateArrowsVisibility(),this._setScrollPosition(t.initialPosition),this.setState({smoothScroll:!t.config.query["no-animation"]})},n.componentDidUpdate=function(e){o.Children.count(e.children)!==o.Children.count(this.props.children)&&this._updateArrowsVisibility()},n.componentWillUnmount=function(){var e=this.props;e.resetCarouselRef&&e.resetCarouselRef(void 0),e.setPositionRef&&e.setPositionRef(void 0),this._scrollable.current.removeEventListener("scroll",this._onScrollThrottled),this._onScrollThrottled.cancel(),this._checkSwipeEndDebounced.cancel()},n.render=function(){var e=this,t=this.props,n=this.state,i=t.expandWidth||{left:0,right:0},a=t.padding||0,s=a+i.left,c=a+i.right,l=o.Children.toArray(t.children).filter(Boolean),d={"old-browsers-workaround":!t.disableOldBrowsersWorkaround,theme:t.theme||"white","show-arrows":"always"===t.showArrows};return o.createElement(p.a,{name:"carousel",useParentState:!0,nodeRef:this._analyticsRef},o.createElement("div",{className:y(d)+(t.className?" "+t.className:""),style:Object(r.a)({height:n.height,marginLeft:-i.left,marginRight:-i.right},t.style),ref:t.forwardedRef},o.createElement(u.a,null,function(r){var i,a;return o.createElement("div",{className:y("scrollable",{snap:t.snap,"smooth-scroll":n.smoothScroll}),style:e._getScrollableContainerStyles(r),ref:e._scrollable,onClickCapture:e._checkClick,onMouseMove:e._onMouseMove},o.createElement("div",{className:y("content"),ref:e._contentRef},l.map(function(e,n){return o.createElement("div",{key:"object"==typeof e&&e&&"key"in e?e.key||void 0:n,className:y("item"),style:{paddingLeft:0===n?s:t.itemsGap,paddingRight:n===l.length-1?c:void 0}},e)}),o.createElement(C.a,{onResize:function(){e._updateHeight(),e._updateArrowsVisibility()}})),null!==(i=null===(a=t.renderInScrollContainer)||void 0===a?void 0:a.call(t))&&void 0!==i?i:null)}),"never"!==t.showArrows?o.createElement(E,{showButtons:n.showButtons,arrowStyle:t.arrowStyle,buttonSize:t.buttonSize,onMouseEnter:this._enterButton,onMouseLeave:this._leaveButton,setOffsetByDirection:this._setOffsetByDirection}):null))},t}(o.Component);t.a=Object(R.a)(Object(d.b)(N))},392:function(e,t,n){"use strict";n(505);var r=n(4),i=n(7),o=n(8),a=n(11),s=n(17),c=n(27),l=n(9),u=n(507),d=n.n(u),p=n(508),m=n.n(p),v=Object(i.a)("business-rating-edit-view"),f=Object(s.a)(c.b,l.b);t.a=f(function(e){return r.createElement("div",{className:v()},[1,2,3,4,5].map(function(t){var n=t<=(e.rating||0);return r.createElement(o.a,{key:t,name:"star",nodeState:{score:t,selected:n},logClick:!0},r.createElement("div",{onClick:function(){return e.onRatingClick(t)},className:v("star",{selected:n,size:e.size||"s",wide:e.isWideCard})},r.createElement(a.a,{url:e.size&&"s"!==e.size?m.a:d.a})))}))})},40:function(e,t,n){"use strict";n.r(t);var r=n(6),i=(n(56),n(4)),o=n(7),a=n(28),s=n(80),c=n(9),l=n(53),u=n(31),d=n(52),p=n(8),m=Object(o.a)("dialog"),v=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._container=i.createRef(),t._ref=i.createRef(),t._focusContainer=function(){if(t._container.current&&(!window.document.activeElement||!t._container.current.contains(window.document.activeElement))){var e=t._ref.current.scrollTop;t._container.current.focus(),t._ref.current.scrollTop=e}},t._onClose=function(){t.props.onClose()},t._onMouseDown=function(e){var n=e.currentTarget,r=!!(n.scrollHeight>n.offsetHeight)&&n.offsetWidth===n.clientWidth?15:0;e.target===e.currentTarget&&e.clientX+r<e.currentTarget.clientWidth&&t._onClose()},t._onScroll=function(){var e=t._ref.current,n=e.clientHeight+e.scrollTop>=e.scrollHeight;t.props.onScrollToEnd&&n&&t.props.onScrollToEnd()},t._renderClose=function(){if(!t.props.showCloseButton)return null;var e=Boolean(!1);return i.createElement(p.a,{name:"close",useParentState:!0,logClick:!0},i.createElement(u.a,{onClick:t._onClose,offset:e?"small":"large",circle:!0,usePortal:!1}))},t._renderContainer=function(){var e=t.props,n=Boolean(!1);return i.createElement("div",{className:m("container"),ref:t._container,tabIndex:1},i.createElement(s.a,{handlers:{key:l.a.ESC,callback:t._onClose,allowInEditable:!0},stopPropagation:!0}),i.createElement("div",{className:m("content",{"with-title":n})},n?i.createElement(a.a,{selector:".body"},i.createElement("div",{className:m("title")},e.mobileTitle)):null,t._renderClose(),e.children))},t._renderDialog=function(){var e=t.props;return i.createElement(p.a,{name:"dialog",useParentState:!0,logClick:!0},i.createElement(i.Fragment,null,i.createElement("div",{className:m({transparent:e.transparent,fullscreen:e.fullscreen,"fit-mobile-content":e.fitMobileContent}),style:e.zIndex?{zIndex:e.zIndex}:void 0,ref:t._ref,onMouseDown:t._onMouseDown,onTouchMove:function(e){return e.preventDefault()},onScroll:t.props.onScrollToEnd?t._onScroll:void 0},t._renderContainer()),i.createElement("div",{className:m("paranja"),style:e.zIndex?{zIndex:e.zIndex-1}:void 0})))},t}Object(r.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.isOpen&&this._focusContainer()},n.componentDidUpdate=function(e){!e.isOpen&&this.props.isOpen&&this._focusContainer()},n.render=function(){var e=this.props,t=e.isOpen?this._renderDialog():null;return e.inline?i.createElement(d.a,null,t):i.createElement(a.a,{selector:".body"},i.createElement(d.a,null,t))},t}(i.Component);t.default=Object(c.b)(v)},427:function(e,t,n){"use strict";var r=n(6),i=n(10),o=n(4),a=n(12),s=n(17),c=n(9),l=n(27),u=n(428),d=n(298),p={changeUserReaction:u.a.changeUserReaction,changeRanking:u.a.changeRanking,changeSelectedTag:u.a.changeSelectedTag,loadReviews:u.a.loadReviews,loadUserReview:u.a.loadUserReview,editReview:u.a.editReview,deleteReview:u.a.deleteReview,restoreReview:u.a.restoreReview,updateReview:u.a.updateReview},m=Object(s.a)(c.b,l.b,a.b(function(e,t){var n=d.a(e,t.result);return Object(i.a)(Object(i.a)({},n),{},{isDeleted:Boolean(n.deletedUserReview),ranking:e.reviews.ranking})},p)),v=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._fetch=function(){var e=t.props;e.result.ratingData.reviewCount>0&&0===e.items.length&&t._loadReviews(),void 0===e.userReview&&e.loadUserReview(e.result)},t._onTagClick=function(e){var n=t.props;n.changeSelectedTag(n.result,n.pageSize,e)},t._updateReview=function(e,n,r){t.props.updateReview(t.props.result,e,n,r)},t._changeUserReaction=function(e,n){var r=t.props,i=r.items.find(function(e){return e.reviewId===n});i&&r.changeUserReaction(r.result,i,e)},t._loadReviews=function(e){var n=t.props,r=Math.floor(n.items.length/n.pageSize);n.loadReviews(n.result,n.pageSize,null!=e?e:r+1)},t._updateRanking=function(e){var n=t.props;n.changeRanking(n.result,n.pageSize,e)},t._editReview=function(e){t.props.editReview(t.props.result,e)},t._deleteReview=function(){t.props.deleteReview(t.props.result)},t._restoreReview=function(){t.props.restoreReview(t.props.result)},t}Object(r.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._fetch()},n.componentDidUpdate=function(e){e.result.id!==this.props.result.id&&this._fetch()},n.render=function(){var e=this.props;return e.children({count:e.count,pageSize:e.pageSize,reviews:e.items,isLoading:e.isLoading,ranking:e.ranking,hasMore:e.items.length<e.count&&0!==e.items.length,loadMore:this._loadReviews,selectedTag:e.selectedTag,tags:e.tags,onTagClick:this._onTagClick,hasReviewSuggestion:e.isWideCard?!e.userReview:!e.userReview&&!e.isDeleted,userReview:e.userReview,isDeleted:e.isDeleted,isUserReviewLoading:void 0===e.userReview,editReview:this._editReview,deleteReview:this._deleteReview,restoreReview:this._restoreReview,updateReview:this._updateReview,addUserReaction:this._changeUserReaction,updateRanking:this._updateRanking})},t}(o.Component);t.a=m(v)},428:function(e,t,n){"use strict";var r=n(26);t.a=Object(r.a)(function(){return n.e("reviews").then(n.bind(null,944))},{loadReviews:!0,loadUserReview:!0,reloadReviews:!0,editReview:!0,deleteReview:!0,restoreReview:!0,updateReview:!0,changeUserReaction:!0,changeRanking:!0,changeSelectedTag:!0})},443:function(e,t,n){"use strict";n.r(t);var r=n(6),i=(n(2670),n(4)),o=n(12),a=n(7),s=n(47),c=n(9),l=n(8),u=n(113),d=(n(2672),n(35)),p="S",m={narrow:{left:60,right:36},wide:{left:124,right:80}},v=Object(a.a)("business-review-photos"),f=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._onPhotoClick=function(e){var n=t.props.photos.map(function(e){return{url:e.urlTemplate.replace("{size}","XXXL"),id:e.photoId}});t.props.showPhoto({meta:{id:e,origin:"review",skipAdvert:!1},photos:n,selectedId:e,isPreviewMode:!1,skipPreviewModeOnExit:!0})},t._renderItem=function(e,n){return i.createElement(l.a,{name:"item",logClick:!0,key:n},i.createElement("div",{className:v("item"),onClick:function(){return t._onPhotoClick(e.photoId)}},i.createElement("div",{className:v("item-img"),style:{backgroundImage:"url("+e.urlTemplate.replace("{size}",p)+")"}})))},t}return Object(r.a)(t,e),t.prototype.render=function(){return i.createElement(l.a,{name:"reviews"},i.createElement(d.a,{clickStep:2,buttonSize:"m",arrowStyle:{topVerticalOffset:44},itemsGap:8,expandWidth:m[this.props.view],className:v()},this.props.photos.map(this._renderItem)))},t}(i.Component),h=(n(2674),n(11)),g=n(2676),w=n.n(g),_=Object(a.a)("business-reactions-view"),b=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderReaction=function(e){var n=t.props,r=n.reactions,o=r.likes,a=r.dislikes,s=r.userReaction,c=n.onClick,u="like"===e,d=u?"LIKE"===s?o+1:o:"DISLIKE"===s?a+1:a,p=u?"LIKE"===s:"DISLIKE"===s;return i.createElement("div",{className:_("container")},i.createElement(l.a,{name:"reactions_"+e,logClick:!0},i.createElement(h.a,{className:_("icon",{highlight:p,dislike:!u}),url:w.a,onClick:c?function(){return c(u?"LIKE":"DISLIKE")}:void 0})),d>0?i.createElement("div",{className:_("counter",{highlight:p})},d):null)},t}return Object(r.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.isInteractive,n=e.isOwn,r=e.reactions,o=r.likes,a=r.dislikes;return i.createElement(l.a,{name:"reactions"},i.createElement("div",{className:_({"non-interactive":!t})},n&&0===o?null:this._renderReaction("like"),n&&0===a?null:this._renderReaction("dislike")))},t}(i.PureComponent),E=n(716),C=n(330),R=n(652),S=n(23),y=n(17),N=Object(a.a)("business-review-view"),O="/support/sprav/manage/reviews.html#requirements",k={checkAuthorization:S.a.checkAuthorization},x=Object(y.a)(o.b(null,k),c.b),I=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._onEdit=function(){var e=t.props,n=e.onEdit,r=e.review;n&&n(r)},t._onDelete=function(){t.props.onDelete&&t.props.onDelete()},t._getUserName=function(){var e=t.props.review;return(e.author?e.author.name:null)||"Анонимный отзыв"},t._getUserAvatar=function(){var e=t.props,n=e.review.author&&e.review.author.avatarUrl?e.review.author.avatarUrl.replace("{size}","islands-68"):void 0;return e.isOwn?e.config.authorization&&e.config.authorization.imageUrl:n},t._addUserReaction=function(e){var n=t.props,r=n.review,i=r.reviewId,o=r.reactions.userReaction,a=n.addUserReaction;a&&a(e===o?"NONE":e,i)},t._renderUserName=function(){var e=t.props.review,n=e.author?e.author.profileUrl:void 0,r=t._getUserName(),o=e.author?e.author.professionLevel:void 0,a=i.createElement("span",{itemProp:"name"},r),s=t._getUserAvatar();return i.createElement(l.a,{name:"user_name",logClick:Boolean(n)},i.createElement("div",{className:N("author"),itemScope:!0,itemProp:"author",itemType:"http://schema.org/Person"},s?i.createElement("meta",{itemProp:"image",content:s}):null,n?i.createElement("a",{target:"_blank",href:n},a):a,o?i.createElement("div",{className:N("author-profession")},o):null))},t._renderUserIcon=function(){var e=t.props.review,n=t._getUserAvatar();return i.createElement("div",{className:N("user-icon")},i.createElement(E.a,{backgroundImage:n,seed:e.author&&e.author.name||e.reviewId,char:n?void 0:t._getUserName()[0],url:e.author?e.author.profileUrl:void 0}))},t._renderDate=function(){var e=t.props,n=e.review.updatedTime,r=e.config;if(!n)return null;var o=new Date(n);return i.createElement("span",{className:N("date")},i.createElement("span",null,Object(s.a)(o,r)),i.createElement("meta",{itemProp:"datePublished",content:o.toISOString()}))},t._renderControlsOrgpage=function(){var e=t.props,n=e.isOwn,r=e.review;return n?i.createElement("div",{className:N("controls")},i.createElement(l.a,{name:"edit",logClick:!0},i.createElement("span",{className:N("edit"),onClick:t._onEdit},r.text?"Редактировать":"Написать отзыв")),i.createElement(l.a,{name:"delete",logClick:!0},i.createElement("span",{className:N("delete"),onClick:t._onDelete},"Удалить"))):null},t._renderRating=function(){var e=Number(t.props.review.rating);return e?i.createElement("div",{className:N("rating")},i.createElement(u.a,{ratingValue:e,onlyStars:!0})):null},t._renderSource=function(){var e=t.props.review;return e.partnerData?i.createElement(l.a,{name:"source_link",logClick:!0},i.createElement("a",{className:N("source-link"),href:e.partnerData.externalUrl,target:"_blank"},(function(params){return "Весь отзыв на "+params.name;})({name:e.partnerData.partnerName}))):null},t._renderExpand=function(e){return e.isCollapsed&&e.isOverflown?i.createElement(l.a,{name:"expand",logClick:!0},i.createElement("span",{className:N("expand"),onClick:e.onClick},"Ещё")):null},t._renderModerationStatus=function(){var e=t.props,n=e.config,r=e.review.moderation;if(!r||"ACCEPTED"===r.status)return null;var o="DECLINED"===r.status;return i.createElement("div",{className:N("moderation-status",{declined:o})},o?"Отклонён":"На проверке",o?i.createElement(l.a,{name:"rules",logClick:!0},i.createElement("a",{className:N("moderation-rules"),href:n.morda.url+O,target:"_blank"},"Посмотреть правила")):null)},t._renderText=function(e){var n=t.props,r=n.review.text;return r?i.createElement("div",{ref:e.ref,className:N("body-text",{collapsed:e.isCollapsed&&!n.isOwn}),"data-nosnippet":!0},r):null},t._renderBody=function(){var e=t.props.review.text;return e?i.createElement("div",{className:N("body")},i.createElement("div",{itemProp:"reviewBody"},i.createElement(C.a,{key:e,renderButton:t._renderExpand},t._renderText)),t._renderSource()):null},t._renderPhotos=function(){var e=t.props,n=e.review,r=e.showPhoto;return 0===n.photos.length?null:i.createElement("div",{className:N("carousel")},i.createElement(f,{showPhoto:r,photos:n.photos,view:t.props.view}))},t._renderReactionsView=function(){var e=t.props,n=e.isOwn,r=e.config.authorization,o=e.review,a=Boolean(!n&&r);return n&&0===o.reactions.likes&&0===o.reactions.dislikes?null:i.createElement("div",{className:N("reactions-container")},i.createElement(b,{reactions:o.reactions,onClick:t._addUserReaction,isInteractive:a,isOwn:n}))},t._renderDeletedReview=function(){return i.createElement("div",{className:N("deleted-review")},i.createElement("div",{className:N("deleted-review-text")},"Ваш отзыв удалён"),i.createElement("div",{className:N("deleted-review-controls")},i.createElement(l.a,{name:"restore",logClick:!0},i.createElement("span",{className:N("restore"),onClick:t.props.onRestore},"Восстановить")),i.createElement(l.a,{name:"write_again",logClick:!0},i.createElement("span",{className:N("write-again"),onClick:t._onEdit},"Написать заново"))))},t}return Object(r.a)(t,e),t.prototype.render=function(){var e=this.props;return e.isDeleted?this._renderDeletedReview():i.createElement(l.a,{name:"review"},i.createElement("div",{className:N(),itemScope:!0,itemProp:"review",itemType:"http://schema.org/Review"},i.createElement("div",{className:N("info")},this._renderUserIcon(),this._renderUserName(),i.createElement("div",{className:N("header")},this._renderRating(),this._renderDate()),this._renderBody(),this._renderPhotos(),e.isOwn?this._renderModerationStatus():null,this._renderReactionsView(),this._renderControlsOrgpage(),e.isDeleted?null:i.createElement("div",{className:N("commentator")},i.createElement(R.a,{entityId:e.review.reviewId,supplierServiceSlug:"ugc",isUserOwner:e.isUserOwner,businessId:e.businessId,hasComments:e.review.hasComments,checkAuthorization:e.checkAuthorization,noCommentsText:"ответить"})))))},t}(i.Component);t.default=x(I)},50:function(e,t,n){"use strict";function r(e,t){var n=e.duration,r=void 0===n?0:n,o=e.element,a=e.targetPosition,s=e.horizontal,c=e.onStart,l=void 0===c?function(){}:c,u=e.onEnd,d=void 0===u?function(){}:u,p=s?o.scrollLeft:o.scrollTop,m=Math.round(a-p);if(a===p)return l(),void d();t.query["no-animation"]&&(r=0);var v,f=0;l(),r?window.requestAnimationFrame(function e(t){v=v||t;var n=t-v;var a=n>=r?1:(c=n/r,c<.5?8*c*c*c*c:1-8*--c*c*c*c);var c;f=p+Math.ceil(m*a);i(o,f,s);a<1?window.requestAnimationFrame(e):d()}):(i(o,a,s),d())}function i(e,t,n){n?e.scrollLeft=t:e.scrollTop=t}function o(){}n.d(t,"a",function(){return r}),t.b=function(e,t){var n=e.targetElement,i=e.duration,a=void 0===i?0:i,s=e.insideElement,c=e.offset,l=void 0===c?0:c,u=e.onStart,d=void 0===u?o:u,p=e.onEnd,m=void 0===p?o:p,v=e.horizontal;if(n&&s){var f=s.getBoundingClientRect(),h=n.getBoundingClientRect();"center"===l&&(l=-1*Math.round(f.width/2-h.width/2));var g=v?s.scrollLeft:s.scrollTop;r({duration:a,element:s,targetPosition:Math.min(g+l+(v?h.left-f.left:h.top-f.top),v?s.scrollWidth:s.scrollHeight),horizontal:v,onStart:d,onEnd:m},t)}}},501:function(e,t,n){"use strict";var r=n(6),i=(n(174),n(4)),o=n(272),a=n(9),s=n(185),c={min:[100,68],max:[5e3,5e3]},l=function(e){function t(){return e.apply(this,arguments)||this}return Object(r.a)(t,e),t.prototype.render=function(){var e=this.props;return i.createElement(o.a,{maxSize:10,photos:e.photos,accept:e.accept,removeUploaded:e.removeUploaded,resolutionRanges:c,photosLoaderProvider:function(t){return s.b.uploadBusinessPhoto({photo:t,businessId:e.businessId,config:e.config})},setPhotosLoader:e.setPhotosLoader,onChange:e.onChange})},t}(i.Component);t.a=Object(a.b)(l)},502:function(e,t,n){"use strict";n(503);var r=n(4),i=n(7),o=n(392),a=Object(i.a)("business-review-form-stars-view");t.a=function(e){var t=e.rating,n=e.onClick;return r.createElement("div",{className:a()},r.createElement("div",{className:a("label")},"Оцените это место"),r.createElement("div",{className:a("stars")},r.createElement(o.a,{rating:t,onRatingClick:n})))}},503:function(e,t,n){},505:function(e,t,n){},507:function(e,t,n){e.exports=n.p+"_/0a8c8bb5aac9a3e8d8d88f46c40359d1.svg"},508:function(e,t,n){e.exports=n.p+"_/1bf84e438bf2d18fcfde8123d95b1a08.svg"},509:function(e,t,n){"use strict";n(510);var r=n(4),i=n(9),o=n(7),a=n(156),s=Object(o.a)("business-review-form-comment-view");t.a=Object(i.b)(function(e){var t=e.description,n=(e.config,e.onChange);return r.createElement("div",{className:s()},r.createElement("div",{className:s("label")},"Комментарий"),r.createElement("span",{className:s("textarea")},r.createElement(a.a,{size:"m",value:t,rows:6,placeholder:"Поделитесь мнением про плюсы и минусы этого места",onChange:n})))})},510:function(e,t,n){},542:function(e,t,n){"use strict";var r=n(6),i=(n(543),n(4)),o=n(7),a=n(8),s=n(88),c=n(22),l=["by_relevance_org","by_time","by_likes_count_desc","by_rating_asc","by_rating_desc"],u={by_time:"По новизне",by_relevance_org:"По умолчанию",by_likes_count_desc:"По популярности",by_rating_asc:"Сначала отрицательные",by_rating_desc:"Сначала положительные"},d=Object(o.a)("rating-ranking-view"),p=function(e){function t(t){var n;return(n=e.call(this,t)||this)._ref=i.createRef(),n._switchPopup=function(){n.setState({isPopupShown:!n.state.isPopupShown})},n._closePopup=function(){n.setState({isPopupShown:!1})},n._selectRanking=function(e){n._closePopup(),n.props.onUpdate(e)},n._renderPopup=function(){return i.createElement(c.a,{isShown:n.state.isPopupShown,getTarget:function(){return n._ref.current},onClose:n._closePopup,position:"bottom-left",restrictPosition:!0,showArrow:!1,offset:{main:8,side:0},type:"map-hint",onScroll:"close"},i.createElement("div",{className:d("popup")},l.map(function(e){return i.createElement(a.a,{key:e,name:"ranking_option",nodeState:{ranking:e},logClick:!0},i.createElement("div",{className:d("popup-line"),onClick:function(){return n._selectRanking(e)}},u[e]))})))},n.state={isPopupShown:!1},n}return Object(r.a)(t,e),t.prototype.render=function(){var e=this.props.ranking;return i.createElement(a.a,{name:"ranking",nodeState:{ranking:e},logClick:!0},i.createElement("div",{className:d(),ref:this._ref,onClick:this._switchPopup},i.createElement("span",null,u[e]),i.createElement(s.a,{isFlipped:this.state.isPopupShown})),this._renderPopup())},t}(i.PureComponent);t.a=p},543:function(e,t,n){},545:function(e,t,n){"use strict";n(546);var r=n(4),i=n(7),o=n(27),a=n(548),s=Object(i.a)("business-summary-rating");t.a=Object(o.b)(function(e){return e.ratingValue?r.createElement("div",{className:s({wide:e.isWideCard})},r.createElement(a.a,e)):null})},546:function(e,t,n){},548:function(e,t,n){"use strict";var r=n(549),i=n.n(r),o=n(4),a=n.n(o),s=n(7),c=n(27),l=n(9),u=n(8),d=n(113),p=n(137),m=n(20),v=n(59),f=Object(m.a)({resolved:{},chunkName:function(){return"good-place"},isReady:function(e){var t=this.resolve(e);return!1!==this.resolved[t]&&!!n.m[t]},importAsync:function(){return n.e("good-place").then(n.bind(null,334))},requireAsync:function(e){var t=this,n=this.resolve(e);return this.resolved[n]=!1,Promise.resolve(this.importAsync(e)).then(function(e){return t.resolved[n]=!0,e})},requireSync:function e(t){var r=this.resolve(t);return n(r)},resolve:function e(){return 334}}),h=Object(s.a)("business-summary-rating-badge-view"),g=function(e){var t=v.b(e.ratingValue,e.config.lang,{min:1,max:1}),n=t[0],r=t[1],i=t[2];return o.createElement(u.a,{name:"business_rating"},o.createElement("div",{className:h({wide:e.isWideCard,"no-review-suggestion":!e.hasReviewSuggestion||e.isUserReviewLoading})},o.createElement("div",{className:h("rating-and-stars")},o.createElement("span",{className:h("rating")},o.createElement("span",{className:h("rating-text")},n),o.createElement("span",{className:h("rating-text",{separator:!0})},r),o.createElement("span",{className:h("rating-text")},i)),o.createElement("div",{className:h("stars-and-count")},o.createElement(d.a,{ratingValue:e.ratingValue,onlyStars:!0}),o.createElement("div",{className:h("rating-count")},o.createElement(p.a,{ratingCount:e.ratingCount,isSummary:!0})))),e.goodPlaceYear?o.createElement(f,{goodPlaceYear:e.goodPlaceYear}):null))};t.a=Object(l.b)(Object(c.b)(g))},549:function(e,t,n){},56:function(e,t,n){},578:function(e,t,n){"use strict";n.r(t);var r=n(6),i=(n(2677),n(4)),o=n(7),a=n(8),s=n(15),c=n(11),l=n(2679),u=n.n(l),d=Object(o.a)("business-review-tags"),p=function(e){function t(t){var n;return(n=e.call(this,t)||this)._showAll=function(){n.setState({allShown:!0})},n._renderTag=function(e){var t=n.props,r=t.selectedTag,o=t.onClick;return i.createElement(a.a,{name:"tag",nodeState:{name:e},logClick:!0,key:e||"all"},i.createElement("div",{className:d("tag")},i.createElement(s.a,{view:e===r?"black":"secondary-gray",size:"small",onClick:function(){return o(e===r?void 0:e)}},e)))},n._renderShowAllArea=function(){var e=n.state.allShown;return i.createElement(a.a,{name:"show_all_tags",logClick:!0},i.createElement("div",{className:d("show-all",{hidden:e}),onClick:n._showAll},"Показать ещё",i.createElement("div",{className:d("arrow-icon")},i.createElement(c.a,{url:u.a}))))},n.state={allShown:Boolean(t.initiallyAllShown)},n}return Object(r.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.tags,n=e.selectedTag,r=this.state.allShown;return i.createElement(a.a,{name:"tags",nodeState:{selectedTag:n}},i.createElement("div",{className:d({"show-all":r||t.length<=3})},t.map(this._renderTag),this._renderShowAllArea()))},t}(i.Component);t.default=p},63:function(e,t,n){},647:function(e,t,n){"use strict";n.r(t);var r=n(13),i=n(6),o=(n(2693),n(4)),a=n(7),s=n(8),c=n(443),l=n(1128),u=n(90),d=Object(a.a)("business-user-review-card-view"),p=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderWriteReview=function(){var e=t.props;return o.createElement("div",{className:d("write-review",{"has-rating":Boolean(e.result.ratingData.ratingValue)})},o.createElement(l.a,Object(r.a)({},e,{businessId:e.result.id})))},t._renderUserReview=function(){var e=t.props;return o.createElement(o.Fragment,null,e.isDeleted?null:o.createElement(u.a,{type:"h2"},"Вы оценили это место"),o.createElement("div",{className:d("review",{deleted:e.isDeleted})},o.createElement(c.default,{review:e.userReview,isDeleted:e.isDeleted,isOwn:!0,onEdit:function(){return e.editReview()},onDelete:e.deleteReview,onRestore:e.restoreReview,showPhoto:e.showPhoto,businessId:e.result.id,businessTitle:e.result.title,isUserOwner:e.result.isUserOwner,view:"narrow"})))},t}return Object(i.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.userReview||e.isDeleted?this._renderUserReview():e.isUserReviewLoading?null:this._renderWriteReview();return t?o.createElement(s.a,{name:"reviews"},o.createElement("div",{className:d()},t)):null},t}(o.Component);t.default=p},65:function(e,t,n){},652:function(e,t,n){"use strict";var r=n(13),i=n(6),o=(n(939),n(4)),a=n(7),s=n(8),c=n(10),l=(n(941),n(84)),u=n.n(l),d=n(9),p=n(18),m=n(344),v=n(25),f={sign:function(e,t){return Object(v.a)("commentator/sign",{query:e},t)}},h=Object(a.a)("commentator-view"),g=["ru","en","kk","tr","uk"],w=function(e){function t(t){var n;return(n=e.call(this,t)||this)._uuid=u.a.v4(),n._getWidgetParams=function(e){var t=n.props;if(t.isReadOnly)return{allowAbsent:!0,readOnly:!0,features:{readOnlyMessage:{enabled:!1}}};if(e&&e.signs&&0!==e.signs.length){var r=e.signs.find(function(e){return"typeInitChatData"===e.type}),i=e.signs.find(function(e){return"typeOfficial"===e.type});return{autoFocus:t.autoFocus,formPosition:"bottom",sort:[{order:"time"}],features:{officiality:i?{token:i.token}:void 0,lazyInit:r?{token:r.token,data:e.initItem}:void 0},noComments:"none"}}},n.state={error:!1},n}Object(i.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this,t=this.props,n=t.config,r=t.entityId;window.Ya=window.Ya||{},window.Ya.Cmnt||(window.Ya.Cmnt=Object(c.a)(Object(c.a)({},window.Ya.Cmnt),{},{theme:"dark"===t.theme?"dark":"maps",lang:g.includes(n.lang)?n.lang:"ru",service:"ugc_maps"}));var i={entityId:r,oid:t.businessId,supplierServiceSlug:t.supplierServiceSlug,checkUserOwner:t.isUserOwner},o=[t.isReadOnly?Promise.resolve(void 0):t.signResponse?Promise.resolve(t.signResponse):f.sign(i,n),Object(m.a)(n.commentatorWidget.widgetUrl)];this._loadAction=p.a.create(Promise.all(o),{success:function(i){var o=i[0],a=e._getWidgetParams(o);a?window.Ya.Cmnt.init(e._uuid,Object(c.a)({apiKey:n.commentatorWidget.apiKey,entityId:r,tld:n.tld,isMobile:!1,supplierServiceSlug:t.supplierServiceSlug},a)):e.setState({error:!0})},fail:function(){e.setState({error:!0})}})},n.componentWillUnmount=function(){var e;null===(e=window.Ya.Cmnt)||void 0===e||e.destroy(this._uuid),p.a.cancel(this._loadAction)},n.render=function(){return this.state.error?null:o.createElement("div",{className:h(),id:this._uuid})},t}(o.PureComponent),_=Object(d.b)(w),b=Object(a.a)("commentator-entry-view"),E=function(e){function t(t){var n;return(n=e.call(this,t)||this)._expandCommentator=function(){var e=n.props;!e.hasComments&&e.checkAuthorization?e.checkAuthorization("commentator",function(){n.setState({isExpanded:!0})}):n.setState({isExpanded:!0})},n.state={isExpanded:!1},n}return Object(i.a)(t,e),t.prototype.render=function(){var e=this.props;return this.state.isExpanded?o.createElement(_,Object(r.a)({},e,{autoFocus:!e.hasComments})):o.createElement("div",{className:b()},o.createElement(s.a,{name:"expand_comment",logClick:!0},o.createElement("span",{className:b("expand"),onClick:this._expandCommentator},e.hasComments?"Посмотреть комментарии":e.noCommentsText)))},t}(o.Component);t.a=E},67:function(e,t,n){e.exports=n.p+"_/5e75b507edc611b46cc0cdfebd5ff33c.svg"},68:function(e,t,n){e.exports=n.p+"_/8156832d990b20d84ae2fa43ba364ee4.svg"},716:function(e,t,n){"use strict";var r=n(13),i=(n(717),n(4)),o=n(7),a=n(8),s=Object(o.a)("user-icon-view");t.a=function(e){var t=e.backgroundImage,n=e.seed,o=e.char,c=e.url,l=t?void 0:function(e){return e.toString().split("").reduce(function(e,t){return e+t.charCodeAt(0)},0)%7+1}(n),u=!t&&o?o.toUpperCase():null,d={className:s({icon:l}),style:t?{backgroundImage:"url("+t+")"}:void 0};return c?i.createElement(a.a,{name:"user_icon",logClick:!0},i.createElement("a",Object(r.a)({target:"_blank",href:c},d),u)):i.createElement("div",d,u)}},717:function(e,t,n){},73:function(e,t,n){"use strict";var r=n(6),i=(n(209),n(4)),o=n(7),a=n(27),s=n(111),c=n(8),l=n(52),u=n(29),d=n(320),p=Object(o.a)("card-dropdown-view"),m=function(e){function t(t){var n;return(n=e.call(this,t)||this)._card=i.createRef(),n._controlAnalyticsRef=i.createRef(),n._onMoreClick=function(e){var t;"A"!==e.target.nodeName&&(null===(t=n._controlAnalyticsRef.current)||void 0===t||t.logEvent("click"),e.preventDefault(),e.stopPropagation(),n.setState({isExpanded:!n.state.isExpanded}))},n._collapseContent=function(){n._content&&(n._content.style.overflow="",n._card.current&&(n._card.current.style.overflow=""),n._animateContent(n._content.offsetHeight,0,n._content))},n._expandContent=function(){n._content&&n._animateContent(0,n._content.offsetHeight,n._content)},n._animateContent=function(e,t,n){n.style[Object(s.b)().styles.transition]="max-height 0.3s",n.style.maxHeight=e+"px",n.getBoundingClientRect(),n.style.maxHeight=t+"px"},n._onTransitionEnd=function(e){e.target===n._content&&n._content&&n._card.current&&(n._content.style[Object(s.b)().styles.transition]="",n._content.style.maxHeight="",n._content.style.overflow="visible",n._card.current.style.overflow="visible")},n._renderContent=function(){var e=n.state.isExpanded,t=n.props;return e?i.createElement(c.a,{name:"content"},i.createElement("div",{className:p("content"),ref:function(e){return n._content=e},onTransitionEnd:n._onTransitionEnd},t.content,void 0===t.delimiter?i.createElement("div",{className:p("delimiter")}):t.delimiter)):null},n._renderChildren=function(){var e=n.props,t=e.children;if(!t)return null;var r=Boolean(!e.arrowHidden&&e.content),o=n.state.isExpanded;return i.createElement("div",null,i.createElement(u.a,{className:e.className,title:e.title,view:e.view,size:e.size,iconUrl:e.iconUrl,icon:e.icon,iconClassName:e.iconClassName,keepIconColor:e.keepIconColor,subcontent:e.subcontent,onClick:e.onClick||(r?n._onMoreClick:void 0),onAdditionalClick:n._onMoreClick,border:e.isLast&&!o||e.hideCardBorder?"hide":void 0,stretchBorder:e.stretchBorder,value:e.value,arrowView:r?o?"up":"down":void 0,noSidePadding:e.noSidePadding},Object(d.a)(t)?t({isExpanded:o}):t,r?i.createElement(c.a,{name:"control",nodeRef:n._controlAnalyticsRef,logClick:!0}):null),i.createElement("div",null))},n.state={isExpanded:Boolean(t.isInitiallyExpanded)},n}Object(r.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(){var e=this.props.isExpanded;"boolean"==typeof e&&this.state.isExpanded!==e&&this.setState({isExpanded:e})},n.render=function(){return i.createElement("div",{ref:this._card,className:p({wide:this.props.isWideCard})},this._renderChildren(),i.createElement(l.a,{onShow:this._expandContent,onHideStart:this._collapseContent},this._renderContent()))},t}(i.Component);t.a=Object(a.b)(m)},835:function(e,t,n){"use strict";var r=n(6),i=(n(836),n(4)),o=n(9),a=n(8),s=n(7),c=n(73),l=n(838),u=n.n(l),d=Object(s.a)("card-personal-rating-snippet"),p=function(e){function t(){return e.apply(this,arguments)||this}return Object(r.a)(t,e),t.prototype.render=function(){var e=this.props;return e.personalRating.last_rate?null:i.createElement(a.a,{name:"personal_rating"},i.createElement("div",{className:d()},i.createElement(c.a,{iconUrl:u.a,iconClassName:d("icon"),keepIconColor:!0,content:i.createElement("div",{className:d("content")},"Персональный рейтинг основан на ваших оценках организаций. Чем больше оценок вы оставляете, тем он точнее."),delimiter:null,isLast:!0},(function(params){return "Подходит вам на "+params.percentage;})({percentage:e.personalRating.score+"%"}))))},t}(i.Component);t.a=Object(o.b)(p)},836:function(e,t,n){},838:function(e,t,n){e.exports=n.p+"_/2a054e9f058fa3bcc28635ea6abe1e5a.svg"},88:function(e,t,n){"use strict";n(150);var r=n(4),i=n(7),o=n(11),a=n(152),s=n.n(a),c=Object(i.a)("flip-icon");t.a=function(e){var t=e.isFlipped;return r.createElement(o.a,{className:c({flipped:t}),url:s.a})}},882:function(e,t,n){"use strict";var r=n(6),i=(n(883),n(4)),o=n(7),a=n(8),s=n(15),c=n(502),l=n(509),u=n(501),d=n(39),p=Object(o.a)("business-review-form"),m=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderSpinner=function(){return t.props.isLoading?i.createElement("div",{className:p("spinner-wrapper")},i.createElement("div",{className:p("spinner")},i.createElement(d.a,{view:"large"}))):null},t._renderHeader=function(){var e=t.props;return i.createElement("div",{className:p("header")},i.createElement("div",{className:p("title")},e.title),e.address?i.createElement("div",{className:p("address"),title:e.address},e.address):null)},t._renderAddPhotos=function(){var e=t.props,n=i.createElement(u.a,{photos:e.photos,setPhotosLoader:e.setPhotosLoader,businessId:e.businessId,onChange:e.onChangePhotos});return e.config.uatraits.isMobile?i.createElement("div",{className:p("row")},i.createElement("div",{className:p("add-photos-text")},"Дополните отзыв фотографиями"),n):n},t}return Object(r.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.description,n=e.rating,r=e.allowSubmit,o=e.updateRate,u=e.photosCount,d=e.updateDescription,m=e.onSubmit,v=e.onClose;return i.createElement(a.a,{name:"review_form"},i.createElement("div",{className:p()},this._renderHeader(),i.createElement("div",{className:p("row")},i.createElement(c.a,{rating:n,onClick:o})),i.createElement("div",{className:p("row")},i.createElement(l.a,{description:t,onChange:d})),this._renderAddPhotos(),i.createElement("div",{className:p("controls")},i.createElement("div",{className:p("controls-item")},i.createElement(a.a,{name:"send_review",nodeState:{rating:Number(n),review:Boolean(t),photosCount:u},logClick:!0},i.createElement(s.a,{view:"primary",size:"medium",disabled:!r,onClick:m},"Отправить"))),i.createElement("div",{className:p("controls-item")},i.createElement(a.a,{name:"cancel",logClick:!0},i.createElement(s.a,{view:"secondary-blue",size:"medium",onClick:v},"Отменить"))))),this._renderSpinner())},t}(i.Component);t.a=m},883:function(e,t,n){},90:function(e,t,n){"use strict";n(301);var r=n(4),i=n(7),o=n(27),a=Object(i.a)("card-section-header");t.a=Object(o.b)(function(e){var t=e.type;return r.createElement("div",{className:a({"small-bottom-gutter":e.smallBottomGutter,"medium-bottom-gutter":e.mediumBottomGutter,wide:e.isWideCard,type:e.type})},r.createElement(t,{className:a("title",{wide:e.isWideCard})},e.children),e.rightContent?r.createElement("div",{className:a("right-content")},e.rightContent):null)})},939:function(e,t,n){},941:function(e,t,n){},944:function(e,t,n){"use strict";n.r(t);var r,i,o,a=n(10),s=n(18),c=n(23),l=n(37),u=n(215),d=n(298),p={loadReviews:function(e,t,n){return function(r,o,a){var c,l=a.config;null===(c=i)||void 0===c||c.cancel(),r(m(e,{isLoading:!0})),i=s.a.create(u.a.fetchReviews({businessId:e.id,page:n,pageSize:t,reqId:e.requestId,selectedTag:d.a(o(),e).selectedTag,ranking:o().reviews.ranking},l),{success:function(t){var n=d.a(o(),e).items,i=t.params,a=i.page,s=i.count,c=t.tags;r(m(e,{count:s,isLoading:!1,items:1===a?t.reviews:[].concat(n.filter(function(e){return!t.reviews.some(function(t){return e.reviewId===t.reviewId})}),t.reviews),tags:c}))},fail:function(){r(m(e,{isLoading:!1}))}})}},loadUserReview:function(e){return function(t,n,i){var o,a=i.config;null===(o=r)||void 0===o||o.cancel(),r=s.a.create(u.a.fetchUserReview({businessId:e.id,reqId:e.requestId},a),{success:function(n){t(m(e,{userReview:n}))},fail:function(){t(m(e,{userReview:void 0}))}})}},reloadReviews:function(e,t){return p.loadReviews(e,t,1)},editReview:function(e,t){return function(n,r){n(c.a.checkAuthorization("reviews",function(){if(t){var i,o,a=d.a(r(),e);n(p.updateReview(e,t,null!==(i=null===(o=a.userReview)||void 0===o?void 0:o.text)&&void 0!==i?i:""))}n(l.a.push({initialRate:t,result:e,mode:"reviews",type:"editor"}))}))}},deleteReview:function(e){return function(t,n){var r=d.a(n(),e).userReview;t(m(e,{deletedUserReview:null!=r?r:void 0,userReview:void 0})),t(p.updateReview(e,0,""))}},restoreReview:function(e){return function(t,n){var r=d.a(n(),e).deletedUserReview;t(m(e,{deletedUserReview:void 0,userReview:r})),r&&t(p.updateReview(e,Number(r.rating)||0,r.text))}},updateReview:function(e,t,n,r){return function(i,a,c){var l,p=c.config;null===(l=o)||void 0===l||l.cancel();var v=d.a(a(),e).deletedUserReview;o=s.a.create(u.a.sendUserReview({businessId:e.id,rating:t,text:n,reqId:e.requestId,photoIds:r},p),{success:function(r){return i(m(e,{deletedUserReview:t||n?void 0:v,userReview:r}))}})}},changeUserReaction:function(e,t,n){return function(r,i,o){var s=o.config,c=d.a(i(),e).items,l=c.findIndex(function(e){return e.reviewId===t.reviewId}),p=c[l],v=p.reactions.userReaction,f=Object(a.a)(Object(a.a)({},p),{},{reactions:Object(a.a)(Object(a.a)({},p.reactions),{},{userReaction:n===v?"NONE":n})});r(m(e,{items:[].concat(c.slice(0,l),[f],c.slice(l+1,c.length))})),u.a.addUserReaction({reaction:n,businessId:e.id,reviewId:t.reviewId,reqId:e.requestId},s)}},changeRanking:function(e,t,n){return function(r,i){var o,s=i().reviews;r({payload:{reviews:Object(a.a)(Object(a.a)({},s),{},{ranking:n,businessReviews:(o={},o[e.id]=s.businessReviews[e.id],o)})},type:"EXTEND"}),r(p.reloadReviews(e,t))}},changeSelectedTag:function(e,t,n){return function(r){r(m(e,{selectedTag:n})),r(p.reloadReviews(e,t))}}};function m(e,t){return function(n,r){var i;n({payload:{reviews:{businessReviews:(i={},i[e.id]=Object(a.a)(Object(a.a)({},d.a(r(),e)),t),i)}},type:"DEEP_EXTEND"})}}t.default=p}}]);