(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["search-snippet-gallery"],{2730:function(e,t,n){},2732:function(e,t,n){e.exports=n.p+"_/3f0774beb590ab0f58aa943d4c28dd45.svg"},2733:function(e,t,n){e.exports=n.p+"_/91a72490e72f3af1efc94bfeed3857b2.svg"},35:function(e,t,n){"use strict";var o=n(10),r=n(6),i=(n(63),n(4)),a=n(2800),l=n(2765),s=n(7),c=n(50),u=n(86),p=n(9),d=(n(65),n(8)),h=n(11),f=n(67),m=n.n(f),_=n(68),v=n.n(_),g={l:m.a,m:v.a},S={l:40,m:32},w=Object(s.a)("carousel"),b=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._onPrevClick=function(e){return e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),t.props.setOffsetByDirection(-1)},t._onNextClick=function(e){return e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),t.props.setOffsetByDirection(1)},t._renderButton=function(e){var n;if(!t.props.showButtons[e])return null;var o=t.props,r=o.arrowStyle,a=void 0===r?{}:r,l=o.buttonSize,s=void 0===l?"l":l,c=a.horizontalOffset,u=void 0===c?0:c,p=a.topVerticalOffset,f=S[s]/2,m=void 0!==p,_=m?p-f:0;return i.createElement("div",{className:w("arrow-wrapper",(n={centered:!m},n[e]=!0,n.size=s,n))},i.createElement(d.a,{name:e,logClick:!0,useParentState:!0},i.createElement("div",{className:w("arrow",{size:s}),style:{margin:_+"px "+u+"px"},onClick:"prev"===e?t._onPrevClick:t._onNextClick,onMouseEnter:t.props.onMouseEnter,onMouseLeave:t.props.onMouseLeave},i.createElement(h.a,{className:w("arrow-image"),url:g[s]}))))},t}return Object(r.a)(t,e),t.prototype.render=function(){return i.createElement(i.Fragment,null,this._renderButton("prev"),this._renderButton("next"))},t}(i.Component),E=n(85),C=n(110),y=21,B=Object(s.a)("carousel"),P=function(e){function t(t){var n;return(n=e.call(this,t)||this)._analyticsRef=i.createRef(),n._scrollable=i.createRef(),n._isProgrammaticScroll=!1,n._contentNode=null,n._elementWidth=0,n._insideButton=!1,n._isClickAllowed=!0,n._isSwiping=!1,n._swipeStartScreen=0,n._getCurrentScreen=function(){var e=n._scrollable.current.scrollLeft/(n._elementWidth+n.props.itemsGap),t=n.props.children.length-1;return Math.max(0,Math.min(t,e))},n._onScroll=function(){n.props.snap&&(n._isSwiping?n._checkSwipeEndDebounced():n._onSwipeStart()),n.props.onScroll&&n._scrollable.current&&n.props.onScroll(n._getCurrentScreen(),n._isProgrammaticScroll),n._updateArrowsVisibility()},n._checkSwipeEnd=function(){var e=n._getCurrentScreen();Math.abs(e-Math.round(e))<.03&&n._onSwipeEnd()},n._onSwipeStart=function(){var e,t;(n._isSwiping=!0,n._swipeStartScreen=Math.round(n._getCurrentScreen()),n._isProgrammaticScroll)||(null===(e=(t=n.props).onSwipeStart)||void 0===e||e.call(t))},n._onSwipeEnd=function(){var e,t,o;Math.round(n._getCurrentScreen())===n._swipeStartScreen||n._isProgrammaticScroll||(null===(e=n._analyticsRef.current)||void 0===e||e.logEvent("swipe"));n._isProgrammaticScroll||(null===(t=(o=n.props).onSwipeEnd)||void 0===t||t.call(o));n._isSwiping=!1,n._isProgrammaticScroll=!1},n._setScrollPosition=function(e){if(void 0!==e){var t=e*(n._elementWidth+n.props.itemsGap);n._setOffset(t)}},n._contentRef=function(e){if(n._contentNode=e,e){var t=n.props.padding,o=void 0===t?0:t,r=n.props.expandWidth||{left:0};n._elementWidth=e.children[0].offsetWidth-(o+r.left),setTimeout(n._updateHeight,0)}},n._updateHeight=function(){n._contentNode&&n.setState({height:n._contentNode.clientHeight})},n._updateArrowsVisibility=function(){var e=n._scrollable.current,t=e.scrollLeft,o=e.scrollWidth-e.clientWidth-t,r=n.props.buttonOffset,i=void 0===r?1:r,a=t>i,l=o>i,s=n.state.showButtons;a===s.prev&&l===s.next||(n.setState({showButtons:{prev:a,next:l}}),n._leaveButton())},n._enterButton=function(){n._insideButton=!0,n._isClickAllowed=!1},n._leaveButton=function(){n._insideButton=!1},n._onMouseMove=function(){n._insideButton||n._isClickAllowed||(n._isClickAllowed=!0)},n._checkClick=function(e){n._isClickAllowed||(e.preventDefault(),e.stopPropagation())},n._setOffset=function(e){var t=n._scrollable.current,o=n.state.smoothScroll;t&&(n._isProgrammaticScroll=!0,"scrollBehavior"in document.body.style?t.scrollLeft=e:Object(c.a)({duration:o?350:0,element:t,horizontal:!0,targetPosition:e},n.props.config))},n._setOffsetByDirection=function(e){if(n._scrollable.current){var t=n.props,o=n._elementWidth+t.itemsGap,r=n._scrollable.current.scrollLeft+(t.clickStep||1)*o*e,i=1===e?Math.floor:Math.ceil;n._setOffset(i(r/o)*o)}},n._getScrollableContainerStyles=function(e){var t=n.props,r=n.state,i=Object(o.a)({},t.scrollContainerStyle);t.snap&&!e.has.snapAlign&&(i.scrollSnapPointsX="repeat("+(n._elementWidth+t.itemsGap)+"px)");var a=r.height;return a&&(i.height=a+y,i.paddingBottom=y),i},t.scrollableRef&&(n._scrollable=t.scrollableRef),n.state={showButtons:{prev:!1,next:!0},smoothScroll:!1},n._onScrollThrottled=Object(a.a)(n._onScroll,20),n._checkSwipeEndDebounced=Object(l.a)(n._checkSwipeEnd,200),n}Object(r.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this,t=this.props;t.resetCarouselRef&&t.resetCarouselRef(function(){return e._setOffset(0)}),t.setPositionRef&&t.setPositionRef(function(t){return e._setScrollPosition(t)}),this._scrollable.current.addEventListener("scroll",this._onScrollThrottled,{passive:!0}),this._updateArrowsVisibility(),this._setScrollPosition(t.initialPosition),this.setState({smoothScroll:!t.config.query["no-animation"]})},n.componentDidUpdate=function(e){i.Children.count(e.children)!==i.Children.count(this.props.children)&&this._updateArrowsVisibility()},n.componentWillUnmount=function(){var e=this.props;e.resetCarouselRef&&e.resetCarouselRef(void 0),e.setPositionRef&&e.setPositionRef(void 0),this._scrollable.current.removeEventListener("scroll",this._onScrollThrottled),this._onScrollThrottled.cancel(),this._checkSwipeEndDebounced.cancel()},n.render=function(){var e=this,t=this.props,n=this.state,r=t.expandWidth||{left:0,right:0},a=t.padding||0,l=a+r.left,s=a+r.right,c=i.Children.toArray(t.children).filter(Boolean),p={"old-browsers-workaround":!t.disableOldBrowsersWorkaround,theme:t.theme||"white","show-arrows":"always"===t.showArrows};return i.createElement(d.a,{name:"carousel",useParentState:!0,nodeRef:this._analyticsRef},i.createElement("div",{className:B(p)+(t.className?" "+t.className:""),style:Object(o.a)({height:n.height,marginLeft:-r.left,marginRight:-r.right},t.style),ref:t.forwardedRef},i.createElement(u.a,null,function(o){var r,a;return i.createElement("div",{className:B("scrollable",{snap:t.snap,"smooth-scroll":n.smoothScroll}),style:e._getScrollableContainerStyles(o),ref:e._scrollable,onClickCapture:e._checkClick,onMouseMove:e._onMouseMove},i.createElement("div",{className:B("content"),ref:e._contentRef},c.map(function(e,n){return i.createElement("div",{key:"object"==typeof e&&e&&"key"in e?e.key||void 0:n,className:B("item"),style:{paddingLeft:0===n?l:t.itemsGap,paddingRight:n===c.length-1?s:void 0}},e)}),i.createElement(E.a,{onResize:function(){e._updateHeight(),e._updateArrowsVisibility()}})),null!==(r=null===(a=t.renderInScrollContainer)||void 0===a?void 0:a.call(t))&&void 0!==r?r:null)}),"never"!==t.showArrows?i.createElement(b,{showButtons:n.showButtons,arrowStyle:t.arrowStyle,buttonSize:t.buttonSize,onMouseEnter:this._enterButton,onMouseLeave:this._leaveButton,setOffsetByDirection:this._setOffsetByDirection}):null))},t}(i.Component);t.a=Object(C.a)(Object(p.b)(P))},50:function(e,t,n){"use strict";function o(e,t){var n=e.duration,o=void 0===n?0:n,i=e.element,a=e.targetPosition,l=e.horizontal,s=e.onStart,c=void 0===s?function(){}:s,u=e.onEnd,p=void 0===u?function(){}:u,d=l?i.scrollLeft:i.scrollTop,h=Math.round(a-d);if(a===d)return c(),void p();t.query["no-animation"]&&(o=0);var f,m=0;c(),o?window.requestAnimationFrame(function e(t){f=f||t;var n=t-f;var a=n>=o?1:(s=n/o,s<.5?8*s*s*s*s:1-8*--s*s*s*s);var s;m=d+Math.ceil(h*a);r(i,m,l);a<1?window.requestAnimationFrame(e):p()}):(r(i,a,l),p())}function r(e,t,n){n?e.scrollLeft=t:e.scrollTop=t}function i(){}n.d(t,"a",function(){return o}),t.b=function(e,t){var n=e.targetElement,r=e.duration,a=void 0===r?0:r,l=e.insideElement,s=e.offset,c=void 0===s?0:s,u=e.onStart,p=void 0===u?i:u,d=e.onEnd,h=void 0===d?i:d,f=e.horizontal;if(n&&l){var m=l.getBoundingClientRect(),_=n.getBoundingClientRect();"center"===c&&(c=-1*Math.round(m.width/2-_.width/2));var v=f?l.scrollLeft:l.scrollTop;o({duration:a,element:l,targetPosition:Math.min(v+c+(f?_.left-m.left:_.top-m.top),f?l.scrollWidth:l.scrollHeight),horizontal:f,onStart:p,onEnd:h},t)}}},63:function(e,t,n){},648:function(e,t,n){"use strict";n.r(t);var o=n(6),r=(n(2730),n(4)),i=n(12),a=n(17),l=n(9),s=n(30),c=n(91),u=n(121),p=n(132),d=n(7),h=n(35),f=n(15),m=n(11),_=n(8),v=n(2732),g=n.n(v),S=n(2733),w=n.n(S),b=n(133),E=Object(d.a)("search-snippet-gallery-view"),C={showPhoto:p.a.show,openCard:u.a.openPreloadedCard,switchBusinessTab:c.a.switchBusinessTab},y=3,B=Object(a.a)(i.b(null,C),l.b),P=function(e){function t(t){var n;return(n=e.call(this,t)||this)._updateButtonVisibility=function(e){var t=0!==Math.round(e);n.setState({isButtonHidden:t})},n._onPhotoClick=function(e,t){e.stopPropagation();var o=n.props,r=o.result;o.openCard(r),o.showPhoto({businessId:r.id,name:r.title,description:r.address,selectedIndex:t,origin:"search-snippet",skipAdvert:s.w(r)},{skipPreviewModeOnExit:!0})},n._onButtonClick=function(e,t){t.stopPropagation();var o=n.props;o.openCard(o.result,{mobileViewState:"expanded"}),o.switchBusinessTab(e)},n._renderPhoto=function(e,t,o){var i=n.props.result.photos.count||0,a=i>o.length?i-o.length:0,l=o.length-1===t,s=o.length>=y&&a>0&&l;return r.createElement(_.a,{key:t,name:s?"more_photos":"photo",logClick:!0},r.createElement("div",{className:E("photo"),onClick:function(e){return n._onPhotoClick(e,l?void 0:t)}},r.createElement(b.a,{src:e.urlTemplate.replace("%s","M"),backgroundSize:"cover"}),s?r.createElement("div",{className:E("overlay")},r.createElement(m.a,{url:w.a}),r.createElement("span",{className:E("more-photos")},(function(params){return "Ещё "+params.count+" фото";})({count:a}))):null))},n._renderButton=function(){var e,t=n.props,o=t.result.topObjects;if(n.state.isButtonHidden)return null;if(s.f(t.result,t.config)?e="booking":o&&(e="food"===o.rubric?"menu":"prices"),!e)return null;var i="menu"===e?"Меню":"Цены";return r.createElement("div",{className:E("button",{"extra-padded":t.allowButtonWithoutCarousel})},r.createElement(_.a,{name:e+"_button",logClick:!0,useParentState:!0},r.createElement(f.a,{onClick:function(t){return n._onButtonClick(e,t)},view:"air",size:"medium",icon:r.createElement(m.a,{className:E("button-icon"),url:g.a})},r.createElement("span",{className:E("button-text")},i))))},n.state={},n}return Object(o.a)(t,e),t.prototype.render=function(){var e=this.props.result;if(!e.photos)return null;var t=e.photos.items.slice(0,Math.min(e.photos.items.length,6)),n=t.length>=y?"carousel":"basic",o=this._renderButton();return r.createElement(_.a,{name:"gallery",nodeState:{galleryType:n},useParentState:!0},r.createElement("div",{className:E({type:n})},"basic"===n?r.createElement(r.Fragment,null,t.map(this._renderPhoto),this.props.allowButtonWithoutCarousel?o:null):r.createElement(r.Fragment,null,r.createElement(h.a,{itemsGap:8,padding:16,onScroll:this._updateButtonVisibility,showArrows:o?"never":void 0},t.map(this._renderPhoto)),o)))},t}(r.Component);t.default=B(P)},65:function(e,t,n){},67:function(e,t,n){e.exports=n.p+"_/5e75b507edc611b46cc0cdfebd5ff33c.svg"},68:function(e,t,n){e.exports=n.p+"_/8156832d990b20d84ae2fa43ba364ee4.svg"}}]);